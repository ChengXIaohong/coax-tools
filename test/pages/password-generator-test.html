<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>密码生成器测试</title>
    <link rel="stylesheet" href="../../css/password-generator.css">
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-case { margin: 20px 0; padding: 15px; border: 1px solid #ccc; border-radius: 5px; }
        .test-result { margin-top: 10px; padding: 10px; border-radius: 3px; }
        .pass { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .fail { background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        button { padding: 10px 15px; background-color: #007bff; color: white; border: none; border-radius: 3px; cursor: pointer; }
        button:hover { background-color: #0056b3; }
        .password-display-test {
            margin: 10px 0;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            background-color: #f9f9f9;
            font-family: monospace;
            word-break: break-all;
        }
        .option-group-test {
            margin: 10px 0;
        }
        .checkbox-item-test {
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <h1>密码生成器测试</h1>
    
    <div class="test-case">
        <h3>测试用例 1: 默认参数生成密码</h3>
        <p>测试使用默认参数（12位，包含大小写字母、数字、符号）生成密码</p>
        <div class="option-group-test">
            <div class="checkbox-item-test">
                <input type="checkbox" id="includeUppercase1" checked> 大写字母 (A-Z)
            </div>
            <div class="checkbox-item-test">
                <input type="checkbox" id="includeLowercase1" checked> 小写字母 (a-z)
            </div>
            <div class="checkbox-item-test">
                <input type="checkbox" id="includeNumbers1" checked> 数字 (0-9)
            </div>
            <div class="checkbox-item-test">
                <input type="checkbox" id="includeSymbols1" checked> 符号 (!@#$%^&*)
            </div>
        </div>
        <button onclick="testDefaultPasswordGeneration()">运行测试</button>
        <div id="defaultPasswordTestResult" class="test-result" style="display:none;"></div>
        <div id="passwordOutput1" class="password-display-test"></div>
    </div>
    
    <div class="test-case">
        <h3>测试用例 2: 自定义长度生成密码</h3>
        <p>测试生成指定长度的密码</p>
        <label>密码长度: <input type="number" id="passwordLength2" min="4" max="50" value="20"></label>
        <button onclick="testCustomLengthPasswordGeneration()">运行测试</button>
        <div id="customLengthTestResult" class="test-result" style="display:none;"></div>
        <div id="passwordOutput2" class="password-display-test"></div>
    </div>
    
    <div class="test-case">
        <h3>测试用例 3: 排除特定字符生成密码</h3>
        <p>测试排除相似字符和模糊字符的密码生成</p>
        <div class="option-group-test">
            <div class="checkbox-item-test">
                <input type="checkbox" id="excludeSimilar3" checked> 排除相似字符 (i, l, 1, L, o, 0, O)
            </div>
            <div class="checkbox-item-test">
                <input type="checkbox" id="excludeAmbiguous3" checked> 排除模糊字符 ({, }, [, ], (, ), /, \, ', ", `, ~, ,, ., ;, :, <, >)
            </div>
        </div>
        <button onclick="testExclusionPasswordGeneration()">运行测试</button>
        <div id="exclusionTestResult" class="test-result" style="display:none;"></div>
        <div id="passwordOutput3" class="password-display-test"></div>
    </div>

    <script>
        // 字符集定义
        const uppercaseChars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
        const lowercaseChars = 'abcdefghijklmnopqrstuvwxyz';
        const numberChars = '0123456789';
        const symbolChars = '!@#$%^&*';
        const similarChars = 'il1LO0';
        const ambiguousChars = '{}[]()/\\\'"`~,;:.<>?';
        
        // 生成密码函数
        function generatePassword(length, options) {
            let charset = '';
            if (options.includeUppercase) charset += uppercaseChars;
            if (options.includeLowercase) charset += lowercaseChars;
            if (options.includeNumbers) charset += numberChars;
            if (options.includeSymbols) charset += symbolChars;
            
            // 排除相似字符
            if (options.excludeSimilar) {
                for (let char of similarChars) {
                    charset = charset.replace(new RegExp(char, 'g'), '');
                }
            }
            
            // 排除模糊字符
            if (options.excludeAmbiguous) {
                for (let char of ambiguousChars) {
                    charset = charset.replace(new RegExp('\\' + char, 'g'), '');
                }
            }
            
            if (charset.length === 0) {
                return '错误：没有可用的字符集';
            }
            
            let password = '';
            for (let i = 0; i < length; i++) {
                const randomIndex = Math.floor(Math.random() * charset.length);
                password += charset[randomIndex];
            }
            
            return password;
        }
        
        // 测试默认参数生成密码
        function testDefaultPasswordGeneration() {
            const options = {
                includeUppercase: document.getElementById('includeUppercase1').checked,
                includeLowercase: document.getElementById('includeLowercase1').checked,
                includeNumbers: document.getElementById('includeNumbers1').checked,
                includeSymbols: document.getElementById('includeSymbols1').checked,
                excludeSimilar: false,
                excludeAmbiguous: false
            };
            
            const password = generatePassword(12, options);
            document.getElementById('passwordOutput1').textContent = password;
            
            // 检查密码是否符合要求
            const hasUppercase = /[A-Z]/.test(password);
            const hasLowercase = /[a-z]/.test(password);
            const hasNumbers = /[0-9]/.test(password);
            const hasSymbols = /[!@#$%^&*]/.test(password);
            const correctLength = password.length === 12;
            
            const passed = hasUppercase && hasLowercase && hasNumbers && hasSymbols && correctLength;
            
            const resultDiv = document.getElementById('defaultPasswordTestResult');
            resultDiv.style.display = 'block';
            resultDiv.className = 'test-result ' + (passed ? 'pass' : 'fail');
            resultDiv.innerHTML = passed 
                ? '测试通过: 默认参数密码生成功能正常' 
                : `测试失败: 长度=${correctLength}, 大写=${hasUppercase}, 小写=${hasLowercase}, 数字=${hasNumbers}, 符号=${hasSymbols}`;
        }
        
        // 测试自定义长度生成密码
        function testCustomLengthPasswordGeneration() {
            const length = parseInt(document.getElementById('passwordLength2').value);
            const options = {
                includeUppercase: true,
                includeLowercase: true,
                includeNumbers: true,
                includeSymbols: true,
                excludeSimilar: false,
                excludeAmbiguous: false
            };
            
            const password = generatePassword(length, options);
            document.getElementById('passwordOutput2').textContent = password;
            
            const correctLength = password.length === length;
            const passed = correctLength;
            
            const resultDiv = document.getElementById('customLengthTestResult');
            resultDiv.style.display = 'block';
            resultDiv.className = 'test-result ' + (passed ? 'pass' : 'fail');
            resultDiv.innerHTML = passed 
                ? `测试通过: ${length}位密码生成功能正常` 
                : `测试失败: 期望长度${length}, 实际长度${password.length}`;
        }
        
        // 测试排除特定字符生成密码
        function testExclusionPasswordGeneration() {
            const options = {
                includeUppercase: true,
                includeLowercase: true,
                includeNumbers: true,
                includeSymbols: true,
                excludeSimilar: document.getElementById('excludeSimilar3').checked,
                excludeAmbiguous: document.getElementById('excludeAmbiguous3').checked
            };
            
            const password = generatePassword(20, options);
            document.getElementById('passwordOutput3').textContent = password;
            
            // 检查是否排除了指定字符
            const hasSimilar = similarChars.split('').some(char => password.includes(char));
            const hasAmbiguous = ambiguousChars.split('').some(char => password.includes(char));
            const correctLength = password.length === 20;
            
            const passed = !hasSimilar && !hasAmbiguous && correctLength;
            
            const resultDiv = document.getElementById('exclusionTestResult');
            resultDiv.style.display = 'block';
            resultDiv.className = 'test-result ' + (passed ? 'pass' : 'fail');
            resultDiv.innerHTML = passed 
                ? '测试通过: 字符排除功能正常' 
                : `测试失败: 长度=${correctLength}, 相似字符=${!hasSimilar}, 模糊字符=${!hasAmbiguous}`;
        }
    </script>
</body>
</html>