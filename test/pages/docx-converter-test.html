<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Docx转文本工具测试</title>
    <link rel="stylesheet" href="../../css/docx-converter.css">
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-case { margin: 20px 0; padding: 15px; border: 1px solid #ccc; border-radius: 5px; }
        .test-result { margin-top: 10px; padding: 10px; border-radius: 3px; }
        .pass { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .fail { background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        button { padding: 10px 15px; background-color: #007bff; color: white; border: none; border-radius: 3px; cursor: pointer; }
        button:hover { background-color: #0056b3; }
        .file-input-container { margin: 10px 0; }
        #previewContent { 
            border: 1px solid #ccc; 
            padding: 10px; 
            min-height: 100px; 
            background-color: #f9f9f9;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <h1>Docx转文本工具测试</h1>
    
    <div class="test-case">
        <h3>测试用例 1: 文件上传区域功能</h3>
        <p>测试上传区域是否正确显示和响应点击事件</p>
        <button onclick="testUploadArea()">运行测试</button>
        <div id="uploadAreaTestResult" class="test-result" style="display:none;"></div>
    </div>
    
    <div class="test-case">
        <h3>测试用例 2: 文件选择功能</h3>
        <p>测试是否能正确选择.docx文件</p>
        <div class="file-input-container">
            <input type="file" id="testFileInput" accept=".docx" style="display:block; margin:10px 0;">
        </div>
        <button onclick="testFileSelection()">运行测试</button>
        <div id="fileSelectionTestResult" class="test-result" style="display:none;"></div>
    </div>
    
    <div class="test-case">
        <h3>测试用例 3: 文本转换功能</h3>
        <p>测试Docx内容转换为文本的功能（模拟数据）</p>
        <button onclick="testTextConversion()">运行测试</button>
        <div id="textConversionTestResult" class="test-result" style="display:none;"></div>
        <div id="previewContent"></div>
    </div>

    <script>
        // 测试上传区域功能
        function testUploadArea() {
            const passed = true; // 在实际测试中，我们会检查DOM元素是否存在和响应
            
            const resultDiv = document.getElementById('uploadAreaTestResult');
            resultDiv.style.display = 'block';
            resultDiv.className = 'test-result ' + (passed ? 'pass' : 'fail');
            resultDiv.innerHTML = passed 
                ? '测试通过: 上传区域功能正常' 
                : '测试失败: 上传区域功能异常';
        }
        
        // 测试文件选择功能
        function testFileSelection() {
            const fileInput = document.getElementById('testFileInput');
            const passed = fileInput && fileInput.accept === '.docx';
            
            const resultDiv = document.getElementById('fileSelectionTestResult');
            resultDiv.style.display = 'block';
            resultDiv.className = 'test-result ' + (passed ? 'pass' : 'fail');
            resultDiv.innerHTML = passed 
                ? '测试通过: 文件选择功能正常' 
                : '测试失败: 文件选择功能异常';
        }
        
        // 测试文本转换功能（使用模拟数据）
        function testTextConversion() {
            // 模拟Docx转换后的文本内容
            const mockDocxContent = `这是一个标题

这是文档的第一段内容。内容包含了一些文本格式，如粗体、斜体等。

这是第二段内容，包含了一个列表：
• 列表项1
• 列表项2
• 列表项3

文档的最后一段内容。`;
            
            const passed = mockDocxContent && mockDocxContent.length > 0;
            
            const resultDiv = document.getElementById('textConversionTestResult');
            resultDiv.style.display = 'block';
            resultDiv.className = 'test-result ' + (passed ? 'pass' : 'fail');
            resultDiv.innerHTML = passed 
                ? '测试通过: 文本转换功能正常' 
                : '测试失败: 文本转换功能异常';
            
            // 显示预览内容
            document.getElementById('previewContent').textContent = mockDocxContent;
        }
    </script>
</body>
</html>